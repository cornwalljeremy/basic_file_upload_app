{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 88, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/Penny/New%20Coding/Basic%20file%20upload%20app/app/api/upload/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from \"next/server\";\nimport { S3Client } from \"@aws-sdk/client-s3\";\nimport { Upload } from \"@aws-sdk/lib-storage\";\n\nconst s3 = new S3Client({\n  region: process.env.AWS_REGION!,\n  credentials: {\n    accessKeyId: process.env.AWS_ACCESS_KEY_ID!,\n    secretAccessKey: process.env.AWS_SECRET_ACCESS_KEY!,\n  },\n});\n\nexport async function POST(req: NextRequest) {\n  try {\n    const formData = await req.formData();\n    const file = formData.get(\"file\") as File;\n\n    if (!file) {\n      return NextResponse.json({ error: \"No file provided\" }, { status: 400 });\n    }\n\n    const buffer = Buffer.from(await file.arrayBuffer());\n    const fileName = file.name;\n\n    // Use the 'Upload' helper instead of PutObjectCommand\n    const parallelUploads3 = new Upload({\n      client: s3,\n      params: {\n        Bucket: process.env.AWS_BUCKET_NAME!,\n        Key: fileName,\n        Body: buffer,\n        ContentType: file.type,\n      },\n      // Optional: fine-tune part size (minimum 5MB for multi-part)\n      queueSize: 4, \n      partSize: 1024 * 1024 * 5, \n      leavePartsOnError: false,\n    });\n\n    await parallelUploads3.done();\n\n    return NextResponse.json({ success: true, fileName });\n  } catch (error: any) {\n    console.error(\"Upload Error:\", error);\n    return NextResponse.json(\n      { error: error.message || \"Upload failed\" },\n      { status: 500 }\n    );\n  }\n}"],"names":[],"mappings":";;;;AAAA;AACA;AACA;AAAA;;;;AAEA,MAAM,KAAK,IAAI,gOAAQ,CAAC;IACtB,QAAQ,QAAQ,GAAG,CAAC,UAAU;IAC9B,aAAa;QACX,aAAa,QAAQ,GAAG,CAAC,iBAAiB;QAC1C,iBAAiB,QAAQ,GAAG,CAAC,qBAAqB;IACpD;AACF;AAEO,eAAe,KAAK,GAAgB;IACzC,IAAI;QACF,MAAM,WAAW,MAAM,IAAI,QAAQ;QACnC,MAAM,OAAO,SAAS,GAAG,CAAC;QAE1B,IAAI,CAAC,MAAM;YACT,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAmB,GAAG;gBAAE,QAAQ;YAAI;QACxE;QAEA,MAAM,SAAS,OAAO,IAAI,CAAC,MAAM,KAAK,WAAW;QACjD,MAAM,WAAW,KAAK,IAAI;QAE1B,sDAAsD;QACtD,MAAM,mBAAmB,IAAI,kLAAM,CAAC;YAClC,QAAQ;YACR,QAAQ;gBACN,QAAQ,QAAQ,GAAG,CAAC,eAAe;gBACnC,KAAK;gBACL,MAAM;gBACN,aAAa,KAAK,IAAI;YACxB;YACA,6DAA6D;YAC7D,WAAW;YACX,UAAU,OAAO,OAAO;YACxB,mBAAmB;QACrB;QAEA,MAAM,iBAAiB,IAAI;QAE3B,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,SAAS;YAAM;QAAS;IACrD,EAAE,OAAO,OAAY;QACnB,QAAQ,KAAK,CAAC,iBAAiB;QAC/B,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE,OAAO,MAAM,OAAO,IAAI;QAAgB,GAC1C;YAAE,QAAQ;QAAI;IAElB;AACF"}}]
}