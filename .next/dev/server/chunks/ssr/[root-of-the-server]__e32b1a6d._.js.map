{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 22, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/Penny/New%20Coding/Basic%20file%20upload%20app/app/actions.ts"],"sourcesContent":["\"use server\";\n\nimport { \n  S3Client, \n  ListObjectsV2Command, \n  GetObjectCommand, \n  DeleteObjectCommand, \n  CopyObjectCommand \n} from \"@aws-sdk/client-s3\";\nimport { getSignedUrl } from \"@aws-sdk/s3-request-presigner\";\n\n// Initialize the S3 Client\nconst s3Client = new S3Client({\n  region: process.env.AWS_REGION!,\n  credentials: {\n    accessKeyId: process.env.AWS_ACCESS_KEY_ID!,\n    secretAccessKey: process.env.AWS_SECRET_ACCESS_KEY!,\n  },\n});\n\n/**\n * Fetches all objects from the S3 bucket\n */\nexport async function getS3Files() {\n  try {\n    const { Contents } = await s3Client.send(\n      new ListObjectsV2Command({\n        Bucket: process.env.AWS_BUCKET_NAME!,\n      })\n    );\n    \n    // Log to server terminal for debugging\n    console.log(\"Found in S3:\", Contents?.length || 0);\n\n    return Contents?.map((f) => ({\n      key: f.Key,\n      size: f.Size,\n    })) || [];\n  } catch (err) {\n    console.error(\"AWS List Error:\", err);\n    return [];\n  }\n}\n\n/**\n * Generates a temporary secure URL to download a private file\n */\nexport async function getDownloadUrl(key: string) {\n  try {\n    const command = new GetObjectCommand({\n      Bucket: process.env.AWS_BUCKET_NAME!,\n      Key: key,\n    });\n\n    // URL expires in 1 hour (3600 seconds)\n    return await getSignedUrl(s3Client, command, { expiresIn: 3600 });\n  } catch (err) {\n    console.error(\"Presigned URL Error:\", err);\n    throw new Error(\"Could not generate download link\");\n  }\n}\n\n/**\n * Deletes a file from the S3 bucket\n */\nexport async function deleteS3File(key: string) {\n  try {\n    await s3Client.send(\n      new DeleteObjectCommand({\n        Bucket: process.env.AWS_BUCKET_NAME!,\n        Key: key,\n      })\n    );\n    return { success: true };\n  } catch (err) {\n    console.error(\"Delete Error:\", err);\n    return { success: false, error: err };\n  }\n}\n\n/**\n * Renames a file by copying it to a new key and deleting the old one\n */\nexport async function renameS3File(oldKey: string, newKey: string) {\n  try {\n    const bucketName = process.env.AWS_BUCKET_NAME!;\n\n    // 1. Copy the object to the new name\n    await s3Client.send(\n      new CopyObjectCommand({\n        Bucket: bucketName,\n        CopySource: `${bucketName}/${oldKey}`,\n        Key: newKey,\n      })\n    );\n\n    // 2. Delete the original object\n    await s3Client.send(\n      new DeleteObjectCommand({\n        Bucket: bucketName,\n        Key: oldKey,\n      })\n    );\n\n    return { success: true };\n  } catch (err) {\n    console.error(\"Rename Error:\", err);\n    return { success: false, error: err };\n  }\n}"],"names":[],"mappings":";;;;;;;;;;;AAEA;AAOA;;;;;AAEA,2BAA2B;AAC3B,MAAM,WAAW,IAAI,gOAAQ,CAAC;IAC5B,QAAQ,QAAQ,GAAG,CAAC,UAAU;IAC9B,aAAa;QACX,aAAa,QAAQ,GAAG,CAAC,iBAAiB;QAC1C,iBAAiB,QAAQ,GAAG,CAAC,qBAAqB;IACpD;AACF;AAKO,eAAe;IACpB,IAAI;QACF,MAAM,EAAE,QAAQ,EAAE,GAAG,MAAM,SAAS,IAAI,CACtC,IAAI,4OAAoB,CAAC;YACvB,QAAQ,QAAQ,GAAG,CAAC,eAAe;QACrC;QAGF,uCAAuC;QACvC,QAAQ,GAAG,CAAC,gBAAgB,UAAU,UAAU;QAEhD,OAAO,UAAU,IAAI,CAAC,IAAM,CAAC;gBAC3B,KAAK,EAAE,GAAG;gBACV,MAAM,EAAE,IAAI;YACd,CAAC,MAAM,EAAE;IACX,EAAE,OAAO,KAAK;QACZ,QAAQ,KAAK,CAAC,mBAAmB;QACjC,OAAO,EAAE;IACX;AACF;AAKO,eAAe,eAAe,GAAW;IAC9C,IAAI;QACF,MAAM,UAAU,IAAI,wOAAgB,CAAC;YACnC,QAAQ,QAAQ,GAAG,CAAC,eAAe;YACnC,KAAK;QACP;QAEA,uCAAuC;QACvC,OAAO,MAAM,IAAA,wMAAY,EAAC,UAAU,SAAS;YAAE,WAAW;QAAK;IACjE,EAAE,OAAO,KAAK;QACZ,QAAQ,KAAK,CAAC,wBAAwB;QACtC,MAAM,IAAI,MAAM;IAClB;AACF;AAKO,eAAe,aAAa,GAAW;IAC5C,IAAI;QACF,MAAM,SAAS,IAAI,CACjB,IAAI,2OAAmB,CAAC;YACtB,QAAQ,QAAQ,GAAG,CAAC,eAAe;YACnC,KAAK;QACP;QAEF,OAAO;YAAE,SAAS;QAAK;IACzB,EAAE,OAAO,KAAK;QACZ,QAAQ,KAAK,CAAC,iBAAiB;QAC/B,OAAO;YAAE,SAAS;YAAO,OAAO;QAAI;IACtC;AACF;AAKO,eAAe,aAAa,MAAc,EAAE,MAAc;IAC/D,IAAI;QACF,MAAM,aAAa,QAAQ,GAAG,CAAC,eAAe;QAE9C,qCAAqC;QACrC,MAAM,SAAS,IAAI,CACjB,IAAI,yOAAiB,CAAC;YACpB,QAAQ;YACR,YAAY,GAAG,WAAW,CAAC,EAAE,QAAQ;YACrC,KAAK;QACP;QAGF,gCAAgC;QAChC,MAAM,SAAS,IAAI,CACjB,IAAI,2OAAmB,CAAC;YACtB,QAAQ;YACR,KAAK;QACP;QAGF,OAAO;YAAE,SAAS;QAAK;IACzB,EAAE,OAAO,KAAK;QACZ,QAAQ,KAAK,CAAC,iBAAiB;QAC/B,OAAO;YAAE,SAAS;YAAO,OAAO;QAAI;IACtC;AACF;;;IAtFsB;IAwBA;IAkBA;IAkBA;;AA5DA,+OAAA;AAwBA,+OAAA;AAkBA,+OAAA;AAkBA,+OAAA"}},
    {"offset": {"line": 135, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/Penny/New%20Coding/Basic%20file%20upload%20app/.next-internal/server/app/page/actions.js%20%28server%20actions%20loader%29"],"sourcesContent":["export {getS3Files as '00a0f2e7b00dfffdcf85368f8adab9714d4a203dac'} from 'ACTIONS_MODULE0'\nexport {getDownloadUrl as '40506e9af6855c30b26ec5f5b1dcef3775284fe451'} from 'ACTIONS_MODULE0'\nexport {deleteS3File as '40d39ce3d5b5c407907d95e226a9cc0ed9dbb49367'} from 'ACTIONS_MODULE0'\nexport {renameS3File as '609bd0ab5a8fb4439a00319427145cb77031f5f7bb'} from 'ACTIONS_MODULE0'\n"],"names":[],"mappings":";AAAA"}}]
}